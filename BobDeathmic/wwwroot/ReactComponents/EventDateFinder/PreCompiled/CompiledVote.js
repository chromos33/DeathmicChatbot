"use strict"; function _instanceof(e, t) { return null != t && "undefined" != typeof Symbol && t[Symbol.hasInstance] ? !!t[Symbol.hasInstance](e) : e instanceof t } function _typeof(e) { return (_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } function _classCallCheck(e, t) { if (!_instanceof(e, t)) throw new TypeError("Cannot call a class as a function") } function _defineProperties(e, t) { for (var a = 0; a < t.length; a++) { var s = t[a]; s.enumerable = s.enumerable || !1, s.configurable = !0, "value" in s && (s.writable = !0), Object.defineProperty(e, s.key, s) } } function _createClass(e, t, a) { return t && _defineProperties(e.prototype, t), a && _defineProperties(e, a), e } function _possibleConstructorReturn(e, t) { return !t || "object" !== _typeof(t) && "function" != typeof t ? _assertThisInitialized(e) : t } function _getPrototypeOf(e) { return (_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) { return e.__proto__ || Object.getPrototypeOf(e) })(e) } function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e } function _inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && _setPrototypeOf(e, t) } function _setPrototypeOf(e, t) { return (_setPrototypeOf = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } var Calendar = function (e) { function t(e) { var a; return _classCallCheck(this, t), (a = _possibleConstructorReturn(this, _getPrototypeOf(t).call(this, e))).state = { data: [], eventEmitter: new EventEmitter, mode: "default" }, a.changeMode = a.changeMode.bind(_assertThisInitialized(a)), a } return _inherits(t, React.Component), _createClass(t, [{ key: "componentWillMount", value: function () { var e = this, t = new XMLHttpRequest; t.open("GET", "/Events/GetEventDates/" + this.props.ID, !0), t.onload = function () { e.setState({ data: JSON.parse(t.responseText) }) }, t.send() } }, { key: "changeMode", value: function (e) { this.setState({ mode: e.target.value }) } }, { key: "render", value: function () { if (void 0 !== this.state.data.Header && this.state.data.Header.length > 0) { var e = this, t = this.state.data.Header.map(function (t) { return React.createElement(EventDate, { mode: e.state.mode, key: t.Date + t.Time, Data: t }) }); return React.createElement("div", null, React.createElement("select", { className: "ml-3 mb-5", onChange: this.changeMode }, React.createElement("option", { value: "default" }, "Standard"), React.createElement("option", { value: "fallback" }, "Mobile Fallback")), React.createElement("div", { className: "EventDateContainer" }, t)) } return React.createElement("span", null, "Loading") } }]), t }(), EventDate = function (e) { function t(e) { var a; return _classCallCheck(this, t), (a = _possibleConstructorReturn(this, _getPrototypeOf(t).call(this, e))).state = { Data: a.props.Data }, a } return _inherits(t, React.Component), _createClass(t, [{ key: "render", value: function () { var e = this, t = 0, a = this.state.Data.Requests.map(function (a) { return t++, React.createElement("div", { className: "row usernode mr-0 ml-0" }, React.createElement("span", { className: "col-6 pt-0 pb-0 pl-0 pr-0" }, a.UserName), React.createElement(StateSelect, { mode: e.props.mode, key: t, canEdit: a.canEdit, requestID: a.AppointmentRequestID, possibleStates: a.States, state: a.State, comment: a.Comment })) }); return a.length > 0 ? React.createElement("div", { key: this.key, className: "EventDate" }, React.createElement("div", { className: "row ml-0 mr-0" }, React.createElement("span", { className: "col-12 text-center bg_dark" }, React.createElement("span", { className: "date" }, this.state.Data.Date), React.createElement("br", null), React.createElement("span", { className: "time" }, this.state.Data.Time))), a) : React.createElement("div", { key: this.key, className: "VoteUser" }, React.createElement("span", { className: "VoteUser_Name" }, this.props.Name)) } }]), t }(), StateSelect = function (e) { function t(e) { var a; return _classCallCheck(this, t), (a = _possibleConstructorReturn(this, _getPrototypeOf(t).call(this, e))).state = { possibleStates: e.possibleStates, State: e.state, RetryCount: 0, comment: e.comment }, a.handleClick = a.handleClick.bind(_assertThisInitialized(a)), a } return _inherits(t, React.Component), _createClass(t, [{ key: "handleClick", value: function (e) { e.target.classList.add("processing"); var t = e, a = e.target, s = t.target.getAttribute("data-value"), n = ""; "3" === s && (n = prompt("Kommentar eingeben", "")), this.SyncStateToServer(this.props.requestID, s, a, n) } }, { key: "SyncStateToServer", value: function (e, t, a, s) { var n = this; $.ajax({ url: "/Events/UpdateRequestState/", type: "GET", data: { requestID: e, state: t, comment: s }, success: function (c) { if (c > 0) n.setState({ State: parseInt(a.getAttribute("data-value")), comment: s }); else if (3 === n.state.RetryCount) confirm("Einer deiner Abstimmungen will grade wohl nicht. Später nochmal probieren"), n.setState({ RetryCount: 0 }); else { var l = n.state.RetryCount + 1; n.setState({ RetryCount: l }), n.SyncStateToServer(e, t, a) } a.classList.remove("processing") } }) } }, { key: "render", value: function () { var e = this; if (this.props.canEdit) { if (this.state.possibleStates.length > 0) { var t = this.state.possibleStates.map(function (t) { return "NotYetVoted" === t ? 0 === e.state.State ? React.createElement("span", { className: "voteoption active", "data-value": "0", key: e.props.key }, React.createElement("i", { className: "fas fa-minus" })) : "default" === e.props.mode ? React.createElement("span", { className: "voteoption", "data-value": "0", onClick: e.handleClick, key: e.props.key }, React.createElement("i", { className: "fas fa-minus" }), React.createElement("span", { className: "lds-dual-ring" })) : React.createElement("a", { href: "/Events/UpdateRequestState/?fallback=true&requestID=" + e.props.requestID + "&state=0", target: "_blank", className: "voteoption", "data-value": "0", key: e.props.key }, React.createElement("i", { className: "fas fa-minus" }), React.createElement("span", { className: "lds-dual-ring" })) : "Available" === t ? 1 === e.state.State ? React.createElement("span", { className: "voteoption greenbg active", "data-value": "1", key: e.props.key }, React.createElement("i", { className: "fas fa-check" }), React.createElement("span", { className: "lds-dual-ring" })) : "default" === e.props.mode ? React.createElement("span", { className: "voteoption greenbg", "data-value": "1", onClick: e.handleClick, onTouchEnd: e.handleClick, key: e.props.key }, React.createElement("i", { className: "fas fa-check" }), React.createElement("span", { className: "lds-dual-ring" })) : React.createElement("a", { href: "/Events/UpdateRequestState/?fallback=true&requestID=" + e.props.requestID + "&state=1", target: "_blank", className: "voteoption greenbg", "data-value": "1", key: e.props.key }, React.createElement("i", { className: "fas fa-check" }), React.createElement("span", { className: "lds-dual-ring" })) : "NotAvailable" === t ? 2 === e.state.State ? React.createElement("span", { className: "voteoption redbg active", "data-value": "2", key: e.props.key }, React.createElement("i", { className: "fas fa-times" }), React.createElement("span", { className: "lds-dual-ring" })) : "default" === e.props.mode ? React.createElement("span", { className: "voteoption redbg", "data-value": "2", onClick: e.handleClick, onTouchEnd: e.handleClick, key: e.props.key }, React.createElement("i", { className: "fas fa-times" }), React.createElement("span", { className: "lds-dual-ring" })) : React.createElement("a", { href: "/Events/UpdateRequestState/?fallback=true&requestID=" + e.props.requestID + "&state=2", target: "_blank", className: "voteoption redbg", "data-value": "2", onClick: e.handleClick, onTouchEnd: e.handleClick, key: e.props.key }, React.createElement("i", { className: "fas fa-times" }), React.createElement("span", { className: "lds-dual-ring" })) : "IfNeedBe" === t ? (console.log(e.state), 3 === e.state.State ? React.createElement("span", { className: "voteoption yellowbg active", "data-value": "3", key: e.props.key, onClick: e.handleClick, onTouchEnd: e.handleClick }, React.createElement("i", { className: "fas fa-question" }), React.createElement("span", { className: "lds-dual-ring" }), "" !== e.state.comment && void 0 !== e.state.comment && null !== e.state.comment && React.createElement("i", { className: "fas fa-info" }), "" !== e.state.comment && void 0 !== e.state.comment && null !== e.state.comment && React.createElement("span", { className: "commentBox" }, e.state.comment)) : "default" === e.props.mode ? React.createElement("span", { className: "voteoption yellowbg", "data-value": "3", onClick: e.handleClick, onTouchEnd: e.handleClick, key: e.props.key }, React.createElement("i", { className: "fas fa-question" }), React.createElement("span", { className: "lds-dual-ring" })) : React.createElement("a", { href: "/Events/UpdateRequestState/?fallback=true&requestID=" + e.props.requestID + "&state=3", target: "_blank", className: "voteoption yellowbg", "data-value": "3", onClick: e.handleClick, onTouchEnd: e.handleClick, key: e.props.key }, React.createElement("i", { className: "fas fa-question" }), React.createElement("span", { className: "lds-dual-ring" }))) : void 0 }); return React.createElement("span", { "data-state": this.state.State, className: "requestNode col-6 pt-0 pb-0 pr-0 pl-0" }, React.createElement("div", { className: "d-flex" }, t)) } } else switch (this.state.State) { case 0: return React.createElement("span", { className: "requestNode col-6 pt-0 pb-0 pr-0 pl-0", "data-state": this.state.State }, React.createElement("div", { className: "d-flex" }, React.createElement("span", { className: "voteoption voteoptionforeign", key: e.props.key }, React.createElement("i", { className: "fas fa-minus" })))); case 1: return React.createElement("span", { className: "requestNode col-6 pt-0 pb-0 pr-0 pl-0", "data-state": this.state.State }, React.createElement("div", { className: "d-flex" }, React.createElement("span", { className: "voteoption greenbg voteoptionforeign", key: e.props.key }, React.createElement("i", { className: "fas fa-check" })))); case 2: return React.createElement("span", { className: "requestNode col-6 pt-0 pb-0 pr-0 pl-0", "data-state": this.state.State }, React.createElement("div", { className: "d-flex" }, React.createElement("span", { className: "voteoption redbg voteoptionforeign", key: e.props.key }, React.createElement("i", { className: "fas fa-times" })))); case 3: return React.createElement("span", { className: "requestNode col-6 pt-0 pb-0 pr-0 pl-0", "data-state": this.state.State }, React.createElement("div", { className: "d-flex" }, React.createElement("span", { className: "voteoption yellowbg voteoptionforeign", key: e.props.key }, React.createElement("i", { className: "fas fa-question" }), "" !== e.state.comment && void 0 !== e.state.comment && null !== e.state.comment && React.createElement("i", { className: "fas fa-info" }), "" !== e.state.comment && void 0 !== e.state.comment && null !== e.state.comment && React.createElement("span", { className: "commentBox" }, e.state.comment)))) }return React.createElement("p", null, " No Users Loaded") } }]), t }();